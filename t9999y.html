 <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قائمة السنافر</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
    <style>
        :root {
            --primary-color: #E50914;
            --dark-color: #141414;
            --light-color: #f4f4f4;
            --secondary-color: #6D6D6D;
            --ad-color: #FFA500;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--dark-color);
            color: #fff;
            line-height: 1.6;
        }
        
        /* Header */
        .header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%);
            position: relative;
            z-index: 100;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-img {
            height: 40px;
            width: auto;
        }
        
        .header h1 {
            color: var(--primary-color);
            font-size: 2rem;
            margin: 0;
        }
        
        /* Search Box */
        .search-box {
            display: flex;
            align-items: center;
            margin-left: 20px;
        }
        
        .search-box input {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            background-color: rgba(255,255,255,0.2);
            color: white;
            width: 200px;
            transition: width 0.3s;
        }
        
        .search-box input:focus {
            width: 300px;
            outline: none;
            background-color: rgba(255,255,255,0.3);
        }
        
        .search-box button {
            background: none;
            border: none;
            color: white;
            margin-right: -35px;
            z-index: 1;
            cursor: pointer;
        }
        
        /* Hero Slider */
        .hero-slider {
            width: 100%;
            height: 70vh;
            position: relative;
            overflow: hidden;
        }
        
        .slider-container {
            width: 100%;
            height: 100%;
        }
        
        .slider-item {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: center;
            padding: 0 60px;
        }
        
        .slider-content {
            max-width: 600px;
            z-index: 2;
        }
        
        .slider-title {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .slider-description {
            font-size: 1.2rem;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .slider-rating {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #FFD700;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .slider-play-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .slider-play-btn:hover {
            background-color: #f40612;
            transform: scale(1.05);
        }
        
        .slider-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.2) 100%);
            z-index: 1;
        }
        
        /* Video Player Section */
        .player-section {
            width: 100%;
            background-color: #000;
            position: relative;
            display: none;
        }
        
        .video-container {
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            position: relative;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Ad Overlay - Fullscreen like YouTube */
        .ad-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: none;
            z-index: 20;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .ad-content {
            width: 100%;
            height: 100%;
            background-color: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .ad-skip {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            z-index: 30;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            border: none;
        }
        
        .ad-skip i {
            margin-right: 5px;
        }
        
        .ad-countdown {
            position: absolute;
            bottom: 20px;
            left: 120px;
            color: white;
            font-size: 0.9rem;
        }
        
        .channel-logo {
            position: absolute;
            top: 20px;
            right: 20px;
            height: 50px;
            width: auto;
            z-index: 10;
            background-color: rgba(0,0,0,0.7);
            padding: 5px;
            border-radius: 5px;
        }
        
        /* Banner Ad */
        .banner-ad {
            width: 100%;
            height: 90px;
            background-color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        /* Now Playing Info */
        .now-playing-info {
            padding: 20px 40px;
            background-color: rgba(20,20,20,0.9);
            border-bottom: 1px solid #333;
        }
        
        .now-playing-title {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .badge {
            background-color: var(--primary-color);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .imdb-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #FFD700;
            font-weight: bold;
        }
        
        .now-playing-meta {
            display: flex;
            gap: 15px;
            color: var(--secondary-color);
            flex-wrap: wrap;
        }
        
        .episode-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: color 0.3s;
            font-size: 1.2rem;
            padding: 10px 15px;
            background-color: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        
        .stat:hover {
            color: var(--primary-color);
            background-color: rgba(255,255,255,0.2);
        }
        
        /* Series Section */
        .series-section {
            padding: 40px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-tabs {
            display: flex;
            gap: 10px;
        }
        
        .tab-btn {
            background-color: #333;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
        }
        
        .series-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .series-card {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .series-card:hover {
            transform: scale(1.05);
            z-index: 2;
        }
        
        .series-thumbnail {
            width: 100%;
            height: 0;
            padding-bottom: 150%;
            background-color: #333;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .series-info {
            padding: 15px 10px;
            background-color: rgba(20,20,20,0.9);
        }
        
        .series-title {
            font-size: 1rem;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: bold;
        }
        
        .series-meta {
            font-size: 0.8rem;
            color: var(--secondary-color);
            margin-bottom: 5px;
        }
        
        /* Episodes Section */
        .episodes-section {
            padding: 40px;
            max-width: 1600px;
            margin: 0 auto;
            display: none;
        }
        
        .episodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .episode-card {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .episode-card:hover {
            transform: scale(1.05);
            z-index: 2;
        }
        
        .episode-number {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            border: 2px solid var(--primary-color);
        }
        
        .free-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--primary-color);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .episode-thumbnail {
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            background-color: #333;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .episode-info {
            padding: 15px 10px;
            background-color: rgba(20,20,20,0.9);
        }
        
        .episode-title {
            font-size: 1rem;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: bold;
        }
        
        .episode-duration {
            font-size: 0.8rem;
            color: var(--secondary-color);
            margin-bottom: 5px;
        }
        
        .episode-stats-small {
            display: flex;
            gap: 10px;
            font-size: 0.8rem;
            color: var(--secondary-color);
        }
        
        .progress-container {
            width: 100%;
            height: 3px;
            background-color: #444;
            margin-top: 8px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
        }
        
        /* Seasons Carousel */
        .seasons-section {
            padding: 20px 40px;
            margin-top: 30px;
        }
        
        .seasons-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: white;
        }
        
        .seasons-carousel {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 20px;
        }
        
        .season-card {
            min-width: 200px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .season-card:hover {
            transform: scale(1.05);
        }
        
        .season-thumbnail {
            width: 100%;
            height: 0;
            padding-bottom: 150%;
            background-color: #333;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
            position: relative;
        }
        
        .season-info {
            padding: 10px 0;
        }
        
        .season-title {
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .season-meta {
            font-size: 0.8rem;
            color: var(--secondary-color);
        }
        
        /* Recommended Section */
        .recommended-section {
            padding: 20px 40px;
            margin-top: 30px;
        }
        
        .recommended-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: white;
        }
        
        .recommended-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        /* Admin Panel */
        .admin-panel {
            background-color: rgba(0,0,0,0.9);
            padding: 30px;
            margin: 20px;
            border-radius: 10px;
            display: none;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .admin-tab {
            background: none;
            border: none;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .admin-tab.active {
            background-color: var(--primary-color);
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        .admin-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }
        
        .admin-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .admin-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .admin-label {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .admin-input {
            padding: 12px;
            background-color: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .admin-select {
            padding: 12px;
            background-color: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .admin-textarea {
            padding: 12px;
            background-color: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 5px;
            font-size: 1rem;
            min-height: 100px;
            resize: vertical;
        }
        
        .admin-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: opacity 0.3s;
            font-size: 1rem;
            margin-top: 10px;
        }
        
        .admin-btn:hover {
            opacity: 0.9;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background-color: #333;
            padding: 15px;
            border-radius: 5px;
        }
        
        .stat-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .stat-details {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .series-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .series-list-item {
            background-color: #444;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .series-list-item:hover {
            background-color: #555;
        }
        
        .series-list-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .series-list-meta {
            font-size: 0.8rem;
            color: #aaa;
        }
        
        /* Admin Toggle Button */
        .admin-toggle {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background-color: var(--primary-color);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            transition: transform 0.3s;
        }
        
        .admin-toggle:hover {
            transform: scale(1.1);
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .series-grid, .episodes-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
            
            .slider-title {
                font-size: 2.5rem;
            }
        }
        
        @media (max-width: 992px) {
            .header {
                padding: 15px 20px;
            }
            
            .series-section, .episodes-section, .now-playing-info {
                padding: 30px 20px;
            }
            
            .now-playing-title {
                font-size: 1.5rem;
            }
            
            .slider-title {
                font-size: 2rem;
            }
            
            .slider-description {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .series-grid, .episodes-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .logo-img {
                height: 30px;
            }
            
            .channel-logo {
                height: 40px;
                top: 15px;
                right: 15px;
            }
            
            .now-playing-title {
                font-size: 1.3rem;
            }
            
            .now-playing-meta {
                font-size: 0.9rem;
            }
            
            .admin-panel {
                padding: 20px 15px;
                margin: 15px;
            }
            
            .admin-toggle {
                width: 50px;
                height: 50px;
                bottom: 20px;
                left: 20px;
            }
            
            .search-box input {
                width: 150px;
            }
            
            .search-box input:focus {
                width: 200px;
            }
            
            .slider-item {
                padding: 0 30px;
            }
            
            .slider-title {
                font-size: 1.8rem;
            }
            
            .slider-description {
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 576px) {
            .series-grid, .episodes-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 10px;
            }
            
            .header {
                flex-direction: column;
                gap: 10px;
                padding: 15px;
            }
            
            .logo-container {
                width: 100%;
                justify-content: center;
            }
            
            .search-box {
                margin-left: 0;
                margin-top: 10px;
                width: 100%;
            }
            
            .search-box input {
                width: 100%;
            }
            
            .now-playing-title {
                font-size: 1.1rem;
            }
            
            .now-playing-meta {
                flex-direction: column;
                gap: 5px;
                font-size: 0.9rem;
            }
            
            .section-tabs {
                flex-direction: column;
                gap: 5px;
            }
            
            .ad-skip {
                bottom: 10px;
                left: 10px;
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            .ad-countdown {
                bottom: 10px;
                left: 90px;
                font-size: 0.8rem;
            }
            
            .stat {
                font-size: 1rem;
                padding: 8px 10px;
            }
            
            .slider-item {
                padding: 0 20px;
            }
            
            .slider-title {
                font-size: 1.5rem;
            }
            
            .slider-description {
                display: none;
            }
            
            .slider-play-btn {
                padding: 10px 15px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <img src="https://via.placeholder.com/150x50?text=SMURFS+LOGO" alt="سنافر" class="logo-img">
            <h1>مشاهدة السنافر</h1>
        </div>
        <div class="search-box">
            <input type="text" placeholder="ابحث عن مسلسل أو فيلم...">
            <button><i class="fas fa-search"></i></button>
        </div>
    </header>
    
    <!-- Hero Slider -->
    <section class="hero-slider" id="heroSlider">
        <div class="slider-container" id="sliderContainer">
            <!-- Slider items will be loaded here -->
        </div>
    </section>
    
    <!-- Video Player Section -->
    <section class="player-section" id="playerSection">
        <!-- Ad Overlay - Fullscreen -->
        <div class="ad-overlay" id="adOverlay">
            <div class="ad-content" id="adContent">
                <button class="ad-skip" id="adSkip">
                    <i class="fas fa-forward"></i> تخطي الإعلان
                </button>
                <div class="ad-countdown" id="adCountdown">الإعلان ينتهي بعد 5 ثواني</div>
                <!-- Ad will be loaded here -->
            </div>
        </div>
        
        <div class="video-container">
            <iframe id="videoPlayer" src="" allowfullscreen></iframe>
            <img src="https://via.placeholder.com/100x50?text=قناة+السنافر" alt="قناة السنافر" class="channel-logo">
        </div>
    </section>
    
    <!-- Banner Ad -->
    <div class="banner-ad" id="bannerAd">
        <!-- Banner ad will be loaded here -->
    </div>
    
    <!-- Now Playing Info -->
    <div class="now-playing-info" id="nowPlayingInfo">
        <h2 class="now-playing-title" id="nowPlayingTitle">
            <span id="nowPlayingTitleText">اختر حلقة للمشاهدة</span>
            <span class="badge">Free</span>
            <span class="imdb-rating">
                <i class="fas fa-star"></i>
                <span id="imdbRating">7.5</span>
            </span>
        </h2>
        <div class="now-playing-meta">
            <span id="nowPlayingNumber"></span>
            <span id="nowPlayingDuration"></span>
        </div>
        <div class="episode-stats">
            <div class="stat" id="viewsStat">
                <i class="fas fa-eye"></i>
                <span id="viewsCount">0</span> مشاهدة
            </div>
            <div class="stat" id="likesStat">
                <i class="fas fa-thumbs-up"></i>
                <span id="likesCount">0</span>
            </div>
            <div class="stat" id="dislikesStat">
                <i class="fas fa-thumbs-down"></i>
                <span id="dislikesCount">0</span>
            </div>
        </div>
    </div>
    
    <!-- Series Section -->
    <section class="series-section" id="seriesSection">
        <h3 class="section-title">
            <span id="contentTypeTitle">قائمة المسلسلات</span>
            <div class="section-tabs">
                <button class="tab-btn active" id="seriesTab">مسلسلات</button>
                <button class="tab-btn" id="moviesTab">أفلام</button>
            </div>
        </h3>
        <div class="series-grid" id="seriesGrid">
            <!-- Series will be loaded here -->
        </div>
    </section>
    
    <!-- Episodes Section -->
    <section class="episodes-section" id="episodesSection">
        <h3 class="section-title">
            <span id="episodesTitle">حلقات المسلسل</span>
            <button class="tab-btn" id="backToSeries"><i class="fas fa-arrow-left"></i> العودة للمسلسلات</button>
        </h3>
        <div class="episodes-grid" id="episodesGrid">
            <!-- Episodes will be loaded here -->
        </div>
    </section>
    
    <!-- Seasons Section -->
    <section class="seasons-section" id="seasonsSection">
        <h3 class="seasons-title">الأجزاء الأخرى</h3>
        <div class="seasons-carousel" id="seasonsCarousel">
            <!-- Seasons will be loaded here -->
        </div>
    </section>
    
    <!-- Recommended Section -->
    <section class="recommended-section" id="recommendedSection">
        <h3 class="recommended-title">مسلسلات قد تعجبك</h3>
        <div class="recommended-grid" id="recommendedGrid">
            <!-- Recommended series will be loaded here -->
        </div>
    </section>
    
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-tabs">
            <button class="admin-tab active" data-tab="series">إدارة المسلسلات</button>
            <button class="admin-tab" data-tab="episodes">إدارة الحلقات</button>
            <button class="admin-tab" data-tab="movies">إدارة الأفلام</button>
            <button class="admin-tab" data-tab="ads">إدارة الإعلانات</button>
            <button class="admin-tab" data-tab="stats">الإحصائيات</button>
            <button class="admin-tab" data-tab="visitors">إحصائيات الزوار</button>
            <button class="admin-tab" data-tab="settings">الإعدادات</button>
        </div>
        
        <!-- Series Tab -->
        <div class="admin-tab-content active" id="seriesTab">
            <h3 class="admin-title">إدارة المسلسلات</h3>
            <button id="addSeriesBtn" class="admin-btn">+ إضافة مسلسل جديد</button>
            
            <div id="seriesForm" style="display: none; margin-top: 20px;">
                <div class="admin-controls">
                    <div class="admin-group">
                        <label class="admin-label">اسم المسلسل:</label>
                        <input type="text" id="seriesTitle" class="admin-input" placeholder="اسم المسلسل...">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">قصة المسلسل:</label>
                        <textarea id="seriesDescription" class="admin-textarea" placeholder="قصة المسلسل..."></textarea>
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">صورة المصغرة:</label>
                        <input type="text" id="seriesThumb" class="admin-input" placeholder="رابط الصورة المصغرة...">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">تقييم المسلسل:</label>
                        <input type="number" id="seriesRating" class="admin-input" placeholder="تقييم المسلسل..." min="0" max="10" step="0.1">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">نوع المسلسل:</label>
                        <input type="text" id="seriesGenre" class="admin-input" placeholder="نوع المسلسل...">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">عدد الحلقات:</label>
                        <input type="number" id="seriesEpisodes" class="admin-input" placeholder="عدد الحلقات..." min="1">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">لغة المسلسل:</label>
                        <input type="text" id="seriesLanguage" class="admin-input" placeholder="لغة المسلسل...">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">دولة المسلسل:</label>
                        <input type="text" id="seriesCountry" class="admin-input" placeholder="دولة المسلسل...">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">رقم الموسم:</label>
                        <input type="number" id="seriesSeason" class="admin-input" placeholder="رقم الموسم..." min="1">
                    </div>
                    <div class="admin-group">
                        <label class="admin-label">حالة المسلسل:</label>
                        <select id="seriesStatus" class="admin-select">
                            <option value="new">جديد</option>
                            <option value="exclusive">حصري</option>
                            <option value="regular">عادي</option>
                        </select>
                    </div>
                </div>
                <div class="btn-group">
                    <button id="saveSeries" class="admin-btn">حفظ المسلسل</button>
                    <button id="cancelSeries" class="admin-btn" style="background-color: #666;">إلغاء</button>
                </div>
            </div>
            
            <div class="admin-title" style="margin-top: 30px;">قائمة المسلسلات</div>
            <div class="series-list" id="seriesList">
                <!-- Series list will be loaded here -->
            </div>
        </div>
        
        <!-- Episodes Tab -->
        <div class="admin-tab-content" id="episodesTab">
            <h3 class="admin-title">إدارة الحلقات</h3>
            <div class="admin-controls">
                <div class="admin-group">
                    <label class="admin-label">اختر مسلسل:</label>
                    <select id="episodeSeries" class="admin-select">
                        <option value="">اختر مسلسل...</option>
                        <!-- Series options will be loaded here -->
                    </select>
                </div>
                <div class="admin-group">
                    <label class="admin-label">رقم الحلقة:</label>
                    <input type="number" id="episodeNumber" class="admin-input" placeholder="رقم الحلقة..." min="1">
                </div>
                <div class="admin-group">
                    <label class="admin-label">عنوان الحلقة:</label>
                    <input type="text" id="episodeTitle" class="admin-input" placeholder="عنوان الحلقة...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">رابط الحلقة:</label>
                    <input type="text" id="episodeUrl" class="admin-input" placeholder="رابط الحلقة...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">رابط الصورة المصغرة:</label>
                    <input type="text" id="episodeThumb" class="admin-input" placeholder="رابط الصورة المصغرة...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">مدة الحلقة (دقائق):</label>
                    <input type="number" id="episodeDuration" class="admin-input" placeholder="مدة الحلقة..." min="1">
                </div>
                <div class="admin-group">
                    <label class="admin-label">تقييم IMDB:</label>
                    <input type="number" id="episodeImdb" class="admin-input" placeholder="تقييم IMDB..." min="0" max="10" step="0.1">
                </div>
            </div>
            <div class="btn-group">
                <button id="saveEpisode" class="admin-btn">حفظ الحلقة</button>
                <button id="closeAdmin" class="admin-btn" style="background-color: #666;">إغلاق اللوحة</button>
            </div>
        </div>
        
        <!-- Movies Tab -->
        <div class="admin-tab-content" id="moviesTab">
            <h3 class="admin-title">إدارة الأفلام</h3>
            <div class="admin-controls">
                <div class="admin-group">
                    <label class="admin-label">عنوان الفيلم:</label>
                    <input type="text" id="movieTitle" class="admin-input" placeholder="عنوان الفيلم...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">رابط الفيلم:</label>
                    <input type="text" id="movieUrl" class="admin-input" placeholder="رابط الفيلم...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">رابط الصورة المصغرة:</label>
                    <input type="text" id="movieThumb" class="admin-input" placeholder="رابط الصورة المصغرة...">
                </div>
                <div class="admin-group">
                    <label class="admin-label">مدة الفيلم (دقائق):</label>
                    <input type="number" id="movieDuration" class="admin-input" placeholder="مدة الفيلم..." min="1">
                </div>
                <div class="admin-group">
                    <label class="admin-label">تقييم IMDB:</label>
                    <input type="number" id="movieImdb" class="admin-input" placeholder="تقييم IMDB..." min="0" max="10" step="0.1">
                </div>
            </div>
            <div class="btn-group">
                <button id="saveMovie" class="admin-btn">حفظ الفيلم</button>
            </div>
        </div>
        
        <!-- Ads Tab -->
        <div class="admin-tab-content" id="adsTab">
            <h3 class="admin-title">إدارة الإعلانات</h3>
            <div class="admin-controls">
                <div class="admin-group">
                    <label class="admin-label">مفتاح Adsterra:</label>
                    <input type="text" id="adsterraKey" class="admin-input" placeholder="أدخل مفتاح Adsterra..." value="YOUR_ADSTERRA_KEY">
                </div>
                <div class="admin-group">
                    <label class="admin-label">مدة إعلان ما قبل التشغيل (ثواني):</label>
                    <input type="number" id="preRollDuration" class="admin-input" value="5" min="5">
                </div>
                <div class="admin-group">
                    <label class="admin-label">تمكين الإعلانات في منتصف التشغيل:</label>
                    <select id="midRollEnabled" class="admin-select">
                        <option value="true">نعم</option>
                        <option value="false">لا</option>
                    </select>
                </div>
                <div class="admin-group">
                    <label class="admin-label">مدة إعلان منتصف التشغيل (ثواني):</label>
                    <input type="number" id="midRollDuration" class="admin-input" value="10" min="5">
                </div>
                <div class="admin-group">
                    <label class="admin-label">تمكين الإعلانات بعد التشغيل:</label>
                    <select id="postRollEnabled" class="admin-select">
                        <option value="true">نعم</option>
                        <option value="false">لا</option>
                    </select>
                </div>
                <div class="admin-group">
                    <label class="admin-label">مدة إعلان بعد التشغيل (ثواني):</label>
                    <input type="number" id="postRollDuration" class="admin-input" value="10" min="5">
                </div>
                <div class="admin-group">
                    <label class="admin-label">تمكين الإعلان الشريطي:</label>
                    <select id="bannerAdEnabled" class="admin-select">
                        <option value="true">نعم</option>
                        <option value="false">لا</option>
                    </select>
                </div>
            </div>
            <div class="btn-group">
                <button id="saveAdsSettings" class="admin-btn">حفظ إعدادات الإعلانات</button>
            </div>
            
            <div class="admin-title" style="margin-top: 30px;">إحصائيات الإعلانات</div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-title">إجمالي عائد الإعلانات</div>
                    <div class="stat-value">$<span id="totalAdRevenue">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">إعلانات ما قبل التشغيل</div>
                    <div class="stat-value"><span id="preRollCount">0</span> مشاهدة</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">إعلانات منتصف التشغيل</div>
                    <div class="stat-value"><span id="midRollCount">0</span> مشاهدة</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">إعلانات بعد التشغيل</div>
                    <div class="stat-value"><span id="postRollCount">0</span> مشاهدة</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">الإعلانات الشريطية</div>
                    <div class="stat-value"><span id="bannerAdCount">0</span> ظهور</div>
                </div>
            </div>
        </div>
        
        <!-- Stats Tab -->
        <div class="admin-tab-content" id="statsTab">
            <h3 class="admin-title">إحصائيات المشاهدات</h3>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-title">إجمالي المشاهدات</div>
                    <div class="stat-value"><span id="totalViews">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">إجمالي الإعجابات</div>
                    <div class="stat-value"><span id="totalLikes">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">إجمالي عدم الإعجاب</div>
                    <div class="stat-value"><span id="totalDislikes">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">الحلقات الأكثر مشاهدة</div>
                    <div class="stat-value"><span id="topEpisode">-</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">الأفلام الأكثر مشاهدة</div>
                    <div class="stat-value"><span id="topMovie">-</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">متوسط وقت المشاهدة</div>
                    <div class="stat-value"><span id="avgWatchTime">0</span> دقيقة</div>
                </div>
            </div>
        </div>
        
        <!-- Visitors Tab -->
        <div class="admin-tab-content" id="visitorsTab">
            <h3 class="admin-title">إحصائيات الزوار</h3>
            <div class="admin-controls">
                <div class="admin-group">
                    <label class="admin-label">الفترة الزمنية:</label>
                    <select id="visitorsTimeRange" class="admin-select">
                        <option value="day">اليوم</option>
                        <option value="week">الأسبوع</option>
                        <option value="month">الشهر</option>
                        <option value="year">السنة</option>
                    </select>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-title">إجمالي الزوار</div>
                    <div class="stat-value"><span id="totalVisitors">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">زوار جدد</div>
                    <div class="stat-value"><span id="newVisitors">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">زوار متكررون</div>
                    <div class="stat-value"><span id="returningVisitors">0</span></div>
                </div>
            </div>
            
            <div class="admin-title" style="margin-top: 30px;">مصادر الزوار</div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-title">فيسبوك</div>
                    <div class="stat-value"><span id="facebookVisitors">0</span></div>
                    <div class="stat-details"><span id="facebookPercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">جوجل</div>
                    <div class="stat-value"><span id="googleVisitors">0</span></div>
                    <div class="stat-details"><span id="googlePercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">يوتيوب</div>
                    <div class="stat-value"><span id="youtubeVisitors">0</span></div>
                    <div class="stat-details"><span id="youtubePercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">تيك توك</div>
                    <div class="stat-value"><span id="tiktokVisitors">0</span></div>
                    <div class="stat-details"><span id="tiktokPercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">انستغرام</div>
                    <div class="stat-value"><span id="instagramVisitors">0</span></div>
                    <div class="stat-details"><span id="instagramPercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">مصادر أخرى</div>
                    <div class="stat-value"><span id="otherVisitors">0</span></div>
                    <div class="stat-details"><span id="otherPercentage">0%</span> من إجمالي الزوار</div>
                </div>
            </div>
            
            <div class="admin-title" style="margin-top: 30px;">أجهزة الزوار</div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-title">هواتف</div>
                    <div class="stat-value"><span id="mobileVisitors">0</span></div>
                    <div class="stat-details"><span id="mobilePercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">حواسيب</div>
                    <div class="stat-value"><span id="desktopVisitors">0</span></div>
                    <div class="stat-details"><span id="desktopPercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">أجهزة لوحية</div>
                    <div class="stat-value"><span id="tabletVisitors">0</span></div>
                    <div class="stat-details"><span id="tabletPercentage">0%</span> من إجمالي الزوار</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">تلفزيونات</div>
                    <div class="stat-value"><span id="tvVisitors">0</span></div>
                    <div class="stat-details"><span id="tvPercentage">0%</span> من إجمالي الزوار</div>
                </div>
            </div>
            
            <div class="admin-title" style="margin-top: 30px;">خريطة الزوار</div>
            <div id="visitorsMap" style="width: 100%; height: 400px; background-color: #333; border-radius: 5px; display: flex; justify-content: center; align-items: center; color: #ccc;">
                خريطة تفاعلية للزوار حسب البلدان
            </div>
        </div>
        
        <!-- Settings Tab -->
        <div class="admin-tab-content" id="settingsTab">
            <h3 class="admin-title">إعدادات النظام</h3>
            <div class="admin-controls">
                <div class="admin-group">
                    <label class="admin-label">عنوان الموقع:</label>
                    <input type="text" id="siteTitle" class="admin-input" placeholder="عنوان الموقع..." value="مشاهدة السنافر">
                </div>
                <div class="admin-group">
                    <label class="admin-label">شعار الموقع:</label>
                    <input type="text" id="siteLogo" class="admin-input" placeholder="رابط الشعار..." value="https://via.placeholder.com/150x50?text=SMURFS+LOGO">
                </div>
                <div class="admin-group">
                    <label class="admin-label">شعار القناة:</label>
                    <input type="text" id="channelLogo" class="admin-input" placeholder="رابط شعار القناة..." value="https://via.placeholder.com/100x50?text=قناة+السنافر">
                </div>
                <div class="admin-group">
                    <label class="admin-label">لون الموقع الأساسي:</label>
                    <input type="color" id="primaryColor" class="admin-input" value="#E50914">
                </div>
                <div class="admin-group">
                    <label class="admin-label">وضع الموقع:</label>
                    <select id="siteMode" class="admin-select">
                        <option value="light">فاتح</option>
                        <option value="dark" selected>داكن</option>
                    </select>
                </div>
                <div class="admin-group">
                    <label class="admin-label">كلمة مرور الأدمن:</label>
                    <input type="password" id="adminPassword" class="admin-input" placeholder="كلمة مرور الأدمن..." value="smurfs123">
                </div>
            </div>
            <div class="btn-group">
                <button id="saveSettings" class="admin-btn">حفظ الإعدادات</button>
            </div>
        </div>
    </div>
    
    <!-- Admin Toggle Button -->
    <div class="admin-toggle" id="adminToggle">
        <i class="fas fa-cog"></i>
    </div>

    <!-- Adsterra Script -->
    <script type="text/javascript">
        atOptions = {
            'key' : 'YOUR_ADSTERRA_KEY',
            'format' : 'iframe',
            'height' : 250,
            'width' : 300,
            'params' : {}
        };
    </script>
    <script type="text/javascript" src="https://www.profitabledisplaynetwork.com/YOUR_ADSTERRA_KEY/invoke.js"></script>
    
    <!-- Slick Slider JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const videoPlayer = document.getElementById('videoPlayer');
            const playerSection = document.getElementById('playerSection');
            const heroSlider = document.getElementById('heroSlider');
            const sliderContainer = document.getElementById('sliderContainer');
            const seriesGrid = document.getElementById('seriesGrid');
            const episodesGrid = document.getElementById('episodesGrid');
            const episodesSection = document.getElementById('episodesSection');
            const seriesSection = document.getElementById('seriesSection');
            const seasonsSection = document.getElementById('seasonsSection');
            const recommendedSection = document.getElementById('recommendedSection');
            const adminPanel = document.getElementById('adminPanel');
            const adminToggle = document.getElementById('adminToggle');
            const closeAdmin = document.getElementById('closeAdmin');
            const nowPlayingTitle = document.getElementById('nowPlayingTitleText');
            const nowPlayingNumber = document.getElementById('nowPlayingNumber');
            const nowPlayingDuration = document.getElementById('nowPlayingDuration');
            const nowPlayingInfo = document.getElementById('nowPlayingInfo');
            const viewsCount = document.getElementById('viewsCount');
            const likesCount = document.getElementById('likesCount');
            const dislikesCount = document.getElementById('dislikesCount');
            const imdbRating = document.getElementById('imdbRating');
            const adOverlay = document.getElementById('adOverlay');
            const adContent = document.getElementById('adContent');
            const adSkip = document.getElementById('adSkip');
            const adCountdown = document.getElementById('adCountdown');
            const bannerAd = document.getElementById('bannerAd');
            const seriesTab = document.getElementById('seriesTab');
            const moviesTab = document.getElementById('moviesTab');
            const backToSeries = document.getElementById('backToSeries');
            const contentTypeTitle = document.getElementById('contentTypeTitle');
            const episodesTitle = document.getElementById('episodesTitle');
            const viewsStat = document.getElementById('viewsStat');
            const likesStat = document.getElementById('likesStat');
            const dislikesStat = document.getElementById('dislikesStat');
            const searchBox = document.querySelector('.search-box input');
            const searchBtn = document.querySelector('.search-box button');
            
            // Admin tabs
            const adminTabs = document.querySelectorAll('.admin-tab');
            const adminTabContents = document.querySelectorAll('.admin-tab-content');
            
            // Admin password
            let ADMIN_PASSWORD = "smurfs123";
            
            // Data
            let series = JSON.parse(localStorage.getItem('smurfsSeries')) || [];
            let episodes = JSON.parse(localStorage.getItem('smurfsEpisodes')) || [];
            let movies = JSON.parse(localStorage.getItem('smurfsMovies')) || [];
            let currentSeries = null;
            let currentEpisode = null;
            let currentMovie = null;
            let watchProgress = JSON.parse(localStorage.getItem('watchProgress')) || {};
            let adTimer;
            let progressInterval;
            let isShowingAd = false;
            let adSettings = JSON.parse(localStorage.getItem('adSettings')) || {
                preRollDuration: 5,
                midRollDuration: 10,
                postRollDuration: 10,
                midRollEnabled: true,
                postRollEnabled: true,
                bannerAdEnabled: true,
                adsterraKey: 'YOUR_ADSTERRA_KEY'
            };
            
            // Stats
            let stats = JSON.parse(localStorage.getItem('stats')) || {
                totalViews: 0,
                totalLikes: 0,
                totalDislikes: 0,
                adStats: {
                    preRollCount: 0,
                    midRollCount: 0,
                    postRollCount: 0,
                    bannerAdCount: 0,
                    totalRevenue: 0
                },
                visitors: {
                    total: 0,
                    new: 0,
                    returning: 0,
                    sources: {
                        facebook: 0,
                        google: 0,
                        youtube: 0,
                        tiktok: 0,
                        instagram: 0,
                        other: 0
                    },
                    devices: {
                        mobile: 0,
                        desktop: 0,
                        tablet: 0,
                        tv: 0
                    },
                    countries: {}
                }
            };
            
            // Initialize
            init();
            
            function init() {
                // Load data
                loadSeries();
                loadEpisodes();
                loadMovies();
                loadAdSettings();
                
                // Setup event listeners
                setupEventListeners();
                
                // Check last played content
                checkLastPlayed();
                
                // Load banner ad
                if (adSettings.bannerAdEnabled) {
                    loadBannerAd();
                }
                
                // Update stats
                updateStats();
                
                // Initialize hero slider
                initHeroSlider();
            }
            
            function loadSeries() {
                // Generate some demo series if none exist
                if (series.length === 0) {
                    const seriesTitles = [
                        "السنافر الجزء الأول",
                        "مغامرات السنافر",
                        "السنافر في المدينة",
                        "السنافر والأبطال"
                    ];
                    
                    seriesTitles.forEach((title, index) => {
                        series.push({
                            id: `series_${index}`,
                            title: title,
                            description: `مسلسل كرتوني عن مغامرات السنافر في الغابة. يتبع المسلسل حياة السنافر الصغيرة الزرقاء التي تعيش في قرية في وسط الغابة.`,
                            thumb: 'https://via.placeholder.com/300x450?text=' + encodeURIComponent(title),
                            rating: (Math.random() * 3 + 7).toFixed(1),
                            genre: "مغامرات، كوميدي",
                            episodes: 26,
                            language: "مدبلج",
                            country: "بلجيكا",
                            season: index + 1,
                            status: index === 0 ? "exclusive" : "regular",
                            views: Math.floor(Math.random() * 100000),
                            likes: Math.floor(Math.random() * 5000),
                            dislikes: Math.floor(Math.random() * 200),
                            createdAt: new Date().toISOString(),
                            isFeatured: index === 0
                        });
                    });
                    saveSeries();
                }
                
                renderSeries();
            }
            
            function loadEpisodes() {
                // Generate some demo episodes if none exist
                if (episodes.length === 0 && series.length > 0) {
                    series.forEach(ser => {
                        for (let i = 1; i <= 5; i++) {
                            episodes.push({
                                id: `episode_${ser.id}_${i}`,
                                seriesId: ser.id,
                                number: i,
                                title: `الحلقة ${i}`,
                                url: '',
                                thumb: 'https://via.placeholder.com/300x170?text=صورة+الحلقة+' + i,
                                duration: 24,
                                imdb: (Math.random() * 3 + 7).toFixed(1),
                                views: Math.floor(Math.random() * 10000),
                                likes: Math.floor(Math.random() * 1000),
                                dislikes: Math.floor(Math.random() * 100),
                                createdAt: new Date().toISOString()
                            });
                        }
                    });
                    saveEpisodes();
                }
            }
            
            function loadMovies() {
                // Generate some demo movies if none exist
                if (movies.length === 0) {
                    const movieTitles = [
                        "السنافر: القرية المفقودة",
                        "السنافر والملك",
                        "مغامرات السنافر",
                        "السنافر والتنين"
                    ];
                    
                    movieTitles.forEach((title, index) => {
                        movies.push({
                            id: `movie_${index}`,
                            title: title,
                            url: '',
                            thumb: 'https://via.placeholder.com/300x170?text=' + encodeURIComponent(title),
                            duration: 90 + Math.floor(Math.random() * 30),
                            imdb: (Math.random() * 3 + 6).toFixed(1),
                            views: Math.floor(Math.random() * 50000),
                            likes: Math.floor(Math.random() * 5000),
                            dislikes: Math.floor(Math.random() * 200),
                            createdAt: new Date().toISOString(),
                            isFeatured: index === 0
                        });
                    });
                    saveMovies();
                }
            }
            
            function loadAdSettings() {
                // Load ad settings from localStorage
                document.getElementById('adsterraKey').value = adSettings.adsterraKey || 'YOUR_ADSTERRA_KEY';
                document.getElementById('preRollDuration').value = adSettings.preRollDuration || 5;
                document.getElementById('midRollDuration').value = adSettings.midRollDuration || 10;
                document.getElementById('postRollDuration').value = adSettings.postRollDuration || 10;
                document.getElementById('midRollEnabled').value = adSettings.midRollEnabled ? 'true' : 'false';
                document.getElementById('postRollEnabled').value = adSettings.postRollEnabled ? 'true' : 'false';
                document.getElementById('bannerAdEnabled').value = adSettings.bannerAdEnabled ? 'true' : 'false';
            }
            
            function saveAdSettings() {
                adSettings = {
                    preRollDuration: parseInt(document.getElementById('preRollDuration').value) || 5,
                    midRollDuration: parseInt(document.getElementById('midRollDuration').value) || 10,
                    postRollDuration: parseInt(document.getElementById('postRollDuration').value) || 10,
                    midRollEnabled: document.getElementById('midRollEnabled').value === 'true',
                    postRollEnabled: document.getElementById('postRollEnabled').value === 'true',
                    bannerAdEnabled: document.getElementById('bannerAdEnabled').value === 'true',
                    adsterraKey: document.getElementById('adsterraKey').value || 'YOUR_ADSTERRA_KEY'
                };
                
                localStorage.setItem('adSettings', JSON.stringify(adSettings));
                
                // Reload banner ad if setting changed
                if (adSettings.bannerAdEnabled) {
                    loadBannerAd();
                } else {
                    bannerAd.innerHTML = '';
                    bannerAd.style.display = 'none';
                }
                
                alert('تم حفظ إعدادات الإعلانات بنجاح');
            }
            
            function renderSeries() {
                seriesGrid.innerHTML = '';
                
                series.forEach(ser => {
                    const seriesCard = document.createElement('div');
                    seriesCard.className = 'series-card';
                    seriesCard.dataset.seriesId = ser.id;
                    
                    const seriesThumbnail = document.createElement('div');
                    seriesThumbnail.className = 'series-thumbnail';
                    seriesThumbnail.style.backgroundImage = `url('${ser.thumb}')`;
                    
                    const freeBadge = document.createElement('div');
                    freeBadge.className = 'free-badge';
                    freeBadge.textContent = 'Free';
                    
                    const seriesInfo = document.createElement('div');
                    seriesInfo.className = 'series-info';
                    
                    const seriesTitleEl = document.createElement('div');
                    seriesTitleEl.className = 'series-title';
                    seriesTitleEl.textContent = ser.title;
                    
                    const seriesMetaEl = document.createElement('div');
                    seriesMetaEl.className = 'series-meta';
                    seriesMetaEl.innerHTML = `
                        <span>${ser.rating} <i class="fas fa-star" style="color: #FFD700;"></i></span>
                        <span>•</span>
                        <span>${ser.season} موسم</span>
                    `;
                    
                    seriesThumbnail.appendChild(freeBadge);
                    seriesInfo.appendChild(seriesTitleEl);
                    seriesInfo.appendChild(seriesMetaEl);
                    seriesCard.appendChild(seriesThumbnail);
                    seriesCard.appendChild(seriesInfo);
                    
                    seriesCard.addEventListener('click', function() {
                        showSeriesEpisodes(ser);
                    });
                    
                    seriesGrid.appendChild(seriesCard);
                });
            }
            
            function renderEpisodes(seriesId) {
                episodesGrid.innerHTML = '';
                
                // Filter episodes by series
                const seriesEpisodes = episodes.filter(ep => ep.seriesId === seriesId);
                
                // Sort episodes by number
                seriesEpisodes.sort((a, b) => a.number - b.number);
                
                seriesEpisodes.forEach(episode => {
                    const episodeCard = document.createElement('div');
                    episodeCard.className = 'episode-card';
                    episodeCard.dataset.episodeId = episode.id;
                    
                    const episodeThumbnail = document.createElement('div');
                    episodeThumbnail.className = 'episode-thumbnail';
                    episodeThumbnail.style.backgroundImage = `url('${episode.thumb}')`;
                    
                    const episodeNum = document.createElement('div');
                    episodeNum.className = 'episode-number';
                    episodeNum.textContent = episode.number;
                    
                    const freeBadge = document.createElement('div');
                    freeBadge.className = 'free-badge';
                    freeBadge.textContent = 'Free';
                    
                    const episodeInfo = document.createElement('div');
                    episodeInfo.className = 'episode-info';
                    
                    const episodeTitleEl = document.createElement('div');
                    episodeTitleEl.className = 'episode-title';
                    episodeTitleEl.textContent = episode.title;
                    
                    const episodeDurationEl = document.createElement('div');
                    episodeDurationEl.className = 'episode-duration';
                    episodeDurationEl.textContent = episode.duration ? `${episode.duration} دقيقة` : '';
                    
                    const episodeStats = document.createElement('div');
                    episodeStats.className = 'episode-stats-small';
                    episodeStats.innerHTML = `
                        <span><i class="fas fa-eye"></i> ${episode.views || 0}</span>
                        <span><i class="fas fa-thumbs-up"></i> ${episode.likes || 0}</span>
                    `;
                    
                    // Add progress indicator
                    const progressContainer = document.createElement('div');
                    progressContainer.className = 'progress-container';
                    
                    const progressBar = document.createElement('div');
                    progressBar.className = 'progress-bar';
                    progressBar.style.width = watchProgress[episode.id] ? `${watchProgress[episode.id].progress}%` : '0%';
                    
                    progressContainer.appendChild(progressBar);
                    
                    episodeThumbnail.appendChild(episodeNum);
                    episodeThumbnail.appendChild(freeBadge);
                    episodeInfo.appendChild(episodeTitleEl);
                    episodeInfo.appendChild(episodeDurationEl);
                    episodeInfo.appendChild(episodeStats);
                    episodeInfo.appendChild(progressContainer);
                    episodeCard.appendChild(episodeThumbnail);
                    episodeCard.appendChild(episodeInfo);
                    
                    episodeCard.addEventListener('click', function() {
                        playEpisode(episode);
                    });
                    
                    episodesGrid.appendChild(episodeCard);
                });
            }
            
            function renderMovies() {
                episodesGrid.innerHTML = '';
                
                movies.forEach(movie => {
                    const movieCard = document.createElement('div');
                    movieCard.className = 'episode-card';
                    movieCard.dataset.movieId = movie.id;
                    
                    const movieThumbnail = document.createElement('div');
                    movieThumbnail.className = 'episode-thumbnail';
                    movieThumbnail.style.backgroundImage = `url('${movie.thumb}')`;
                    
                    const freeBadge = document.createElement('div');
                    freeBadge.className = 'free-badge';
                    freeBadge.textContent = 'Free';
                    
                    const movieInfo = document.createElement('div');
                    movieInfo.className = 'episode-info';
                    
                    const movieTitleEl = document.createElement('div');
                    movieTitleEl.className = 'episode-title';
                    movieTitleEl.textContent = movie.title;
                    
                    const movieDurationEl = document.createElement('div');
                    movieDurationEl.className = 'episode-duration';
                    movieDurationEl.textContent = movie.duration ? `${movie.duration} دقيقة` : '';
                    
                    const movieStats = document.createElement('div');
                    movieStats.className = 'episode-stats-small';
                    movieStats.innerHTML = `
                        <span><i class="fas fa-eye"></i> ${movie.views || 0}</span>
                        <span><i class="fas fa-thumbs-up"></i> ${movie.likes || 0}</span>
                    `;
                    
                    movieThumbnail.appendChild(freeBadge);
                    movieInfo.appendChild(movieTitleEl);
                    movieInfo.appendChild(movieDurationEl);
                    movieInfo.appendChild(movieStats);
                    movieCard.appendChild(movieThumbnail);
                    movieCard.appendChild(movieInfo);
                    
                    movieCard.addEventListener('click', function() {
                        playMovie(movie);
                    });
                    
                    episodesGrid.appendChild(movieCard);
                });
            }
            
            function showSeriesEpisodes(series) {
                currentSeries = series;
                episodesTitle.textContent = `حلقات ${series.title}`;
                
                // Hide series section and show episodes section
                seriesSection.style.display = 'none';
                episodesSection.style.display = 'block';
                seasonsSection.style.display = 'block';
                recommendedSection.style.display = 'block';
                playerSection.style.display = 'none';
                heroSlider.style.display = 'none';
                
                // Render episodes for this series
                renderEpisodes(series.id);
                
                // Render other seasons
                renderOtherSeasons(series);
                
                // Render recommended series
                renderRecommendedSeries(series);
            }
            
            function renderOtherSeasons(currentSeries) {
                const seasonsCarousel = document.getElementById('seasonsCarousel');
                seasonsCarousel.innerHTML = '';
                
                // Find other seasons of the same series (different season number)
                const otherSeasons = series.filter(s => 
                    s.title.includes(currentSeries.title.split(' الجزء ')[0]) && 
                    s.id !== currentSeries.id);
                
                if (otherSeasons.length === 0) {
                    seasonsSection.style.display = 'none';
                    return;
                }
                
                otherSeasons.forEach(season => {
                    const seasonCard = document.createElement('div');
                    seasonCard.className = 'season-card';
                    seasonCard.dataset.seriesId = season.id;
                    
                    const seasonThumbnail = document.createElement('div');
                    seasonThumbnail.className = 'season-thumbnail';
                    seasonThumbnail.style.backgroundImage = `url('${season.thumb}')`;
                    
                    const seasonInfo = document.createElement('div');
                    seasonInfo.className = 'season-info';
                    
                    const seasonTitle = document.createElement('div');
                    seasonTitle.className = 'season-title';
                    seasonTitle.textContent = season.title;
                    
                    const seasonMeta = document.createElement('div');
                    seasonMeta.className = 'season-meta';
                    seasonMeta.textContent = `${season.episodes} حلقة | ${season.rating} ⭐`;
                    
                    seasonInfo.appendChild(seasonTitle);
                    seasonInfo.appendChild(seasonMeta);
                    seasonCard.appendChild(seasonThumbnail);
                    seasonCard.appendChild(seasonInfo);
                    
                    seasonCard.addEventListener('click', function() {
                        showSeriesEpisodes(season);
                    });
                    
                    seasonsCarousel.appendChild(seasonCard);
                });
            }
            
            function renderRecommendedSeries(currentSeries) {
                const recommendedGrid = document.getElementById('recommendedGrid');
                recommendedGrid.innerHTML = '';
                
                // Find recommended series (same genre, high rating)
                const recommended = series
                    .filter(s => 
                        s.id !== currentSeries.id && 
                        (s.genre.includes(currentSeries.genre.split('،')[0]) || s.rating >= 7.5))
                    .sort((a, b) => b.rating - a.rating)
                    .slice(0, 10);
                
                if (recommended.length === 0) {
                    recommendedSection.style.display = 'none';
                    return;
                }
                
                recommended.forEach(ser => {
                    const seriesCard = document.createElement('div');
                    seriesCard.className = 'series-card';
                    seriesCard.dataset.seriesId = ser.id;
                    
                    const seriesThumbnail = document.createElement('div');
                    seriesThumbnail.className = 'series-thumbnail';
                    seriesThumbnail.style.backgroundImage = `url('${ser.thumb}')`;
                    
                    const seriesInfo = document.createElement('div');
                    seriesInfo.className = 'series-info';
                    
                    const seriesTitleEl = document.createElement('div');
                    seriesTitleEl.className = 'series-title';
                    seriesTitleEl.textContent = ser.title;
                    
                    const seriesMetaEl = document.createElement('div');
                    seriesMetaEl.className = 'series-meta';
                    seriesMetaEl.innerHTML = `
                        <span>${ser.rating} <i class="fas fa-star" style="color: #FFD700;"></i></span>
                    `;
                    
                    seriesInfo.appendChild(seriesTitleEl);
                    seriesInfo.appendChild(seriesMetaEl);
                    seriesCard.appendChild(seriesThumbnail);
                    seriesCard.appendChild(seriesInfo);
                    
                    seriesCard.addEventListener('click', function() {
                        showSeriesEpisodes(ser);
                    });
                    
                    recommendedGrid.appendChild(seriesCard);
                });
            }
            
            function initHeroSlider() {
                sliderContainer.innerHTML = '';
                
                // Get featured content (series and movies with isFeatured = true)
                const featuredSeries = series.filter(s => s.isFeatured);
                const featuredMovies = movies.filter(m => m.isFeatured);
                const featuredContent = [...featuredSeries, ...featuredMovies];
                
                if (featuredContent.length === 0) {
                    heroSlider.style.display = 'none';
                    return;
                }
                
                featuredContent.forEach(item => {
                    const sliderItem = document.createElement('div');
                    sliderItem.className = 'slider-item';
                    sliderItem.style.backgroundImage = `url('${item.thumb}')`;
                    
                    const sliderOverlay = document.createElement('div');
                    sliderOverlay.className = 'slider-overlay';
                    
                    const sliderContent = document.createElement('div');
                    sliderContent.className = 'slider-content';
                    
                    const sliderTitle = document.createElement('h2');
                    sliderTitle.className = 'slider-title';
                    sliderTitle.textContent = item.title;
                    
                    const sliderDescription = document.createElement('p');
                    sliderDescription.className = 'slider-description';
                    sliderDescription.textContent = item.description || 'محتوى مميز وجديد على المنصة';
                    
                    const sliderRating = document.createElement('div');
                    sliderRating.className = 'slider-rating';
                    sliderRating.innerHTML = `
                        <span>${item.rating}</span>
                        <i class="fas fa-star"></i>
                    `;
                    
                    const sliderPlayBtn = document.createElement('button');
                    sliderPlayBtn.className = 'slider-play-btn';
                    sliderPlayBtn.innerHTML = `
                        <i class="fas fa-play"></i>
                        <span>تشغيل</span>
                    `;
                    
                    sliderPlayBtn.addEventListener('click', function() {
                        if (item.number) {
                            // It's an episode
                            playEpisode(item);
                        } else if (item.seriesId) {
                            // It's a series - play first episode
                            const firstEpisode = episodes.find(ep => ep.seriesId === item.id);
                            if (firstEpisode) {
                                playEpisode(firstEpisode);
                            }
                        } else {
                            // It's a movie
                            playMovie(item);
                        }
                    });
                    
                    sliderContent.appendChild(sliderTitle);
                    sliderContent.appendChild(sliderDescription);
                    sliderContent.appendChild(sliderRating);
                    sliderContent.appendChild(sliderPlayBtn);
                    sliderItem.appendChild(sliderOverlay);
                    sliderItem.appendChild(sliderContent);
                    sliderContainer.appendChild(sliderItem);
                });
                
                // Initialize slick slider
                $(sliderContainer).slick({
                    dots: true,
                    infinite: true,
                    speed: 500,
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    autoplay: true,
                    autoplaySpeed: 5000,
                    rtl: true
                });
            }
            
            function playEpisode(episode) {
                if (!episode.url) {
                    alert('لا يوجد رابط لهذه الحلقة بعد');
                    return;
                }
                
                currentEpisode = episode;
                currentMovie = null;
                
                // Update views count
                episode.views = (episode.views || 0) + 1;
                stats.totalViews++;
                saveEpisodes();
                saveStats();
                
                // Update now playing info
                updateNowPlayingInfo(episode);
                
                // Show player and hide other sections
                playerSection.style.display = 'block';
                heroSlider.style.display = 'none';
                seriesSection.style.display = 'none';
                episodesSection.style.display = 'none';
                seasonsSection.style.display = 'none';
                recommendedSection.style.display = 'none';
                
                // Reset ad flags for this episode
                episode.preRollShown = false;
                episode.midRollShown = false;
                episode.postRollShown = false;
                
                // Show pre-roll ad if enabled
                if (adSettings.preRollDuration > 0 && !episode.preRollShown) {
                    episode.preRollShown = true;
                    showAd('pre-roll', () => {
                        // After ad completes, play the episode
                        playContent(episode.url, episode);
                    });
                } else {
                    playContent(episode.url, episode);
                }
            }
            
            function playMovie(movie) {
                if (!movie.url) {
                    alert('لا يوجد رابط لهذا الفيلم بعد');
                    return;
                }
                
                currentMovie = movie;
                currentEpisode = null;
                
                // Update views count
                movie.views = (movie.views || 0) + 1;
                stats.totalViews++;
                saveMovies();
                saveStats();
                
                // Update now playing info
                updateNowPlayingInfo(movie);
                
                // Show player and hide other sections
                playerSection.style.display = 'block';
                heroSlider.style.display = 'none';
                seriesSection.style.display = 'none';
                episodesSection.style.display = 'none';
                seasonsSection.style.display = 'none';
                recommendedSection.style.display = 'none';
                
                // Reset ad flags for this movie
                movie.preRollShown = false;
                movie.midRollShown = false;
                movie.postRollShown = false;
                
                // Show pre-roll ad if enabled
                if (adSettings.preRollDuration > 0 && !movie.preRollShown) {
                    movie.preRollShown = true;
                    showAd('pre-roll', () => {
                        // After ad completes, play the movie
                        playContent(movie.url, movie);
                    });
                } else {
                    playContent(movie.url, movie);
                }
            }
            
            function updateNowPlayingInfo(content) {
                nowPlayingTitle.textContent = content.title;
                nowPlayingNumber.textContent = content.number ? `الحلقة ${content.number}` : '';
                nowPlayingDuration.textContent = content.duration ? `${content.duration} دقيقة` : '';
                viewsCount.textContent = content.views || 0;
                likesCount.textContent = content.likes || 0;
                dislikesCount.textContent = content.dislikes || 0;
                imdbRating.textContent = content.imdb || '7.5';
                
                // Show the info section if hidden
                nowPlayingInfo.style.display = 'block';
                
                // Update interaction buttons
                updateInteractionButtons(content);
            }
            
            function updateInteractionButtons(content) {
                // Clear previous event listeners
                likesStat.onclick = null;
                dislikesStat.onclick = null;
                
                // Add new event listeners
                likesStat.onclick = function() {
                    content.likes = (content.likes || 0) + 1;
                    stats.totalLikes++;
                    if (currentEpisode) {
                        saveEpisodes();
                    } else {
                        saveMovies();
                    }
                    saveStats();
                    updateNowPlayingInfo(content);
                    alert('شكراً لك على الإعجاب!');
                };
                
                dislikesStat.onclick = function() {
                    content.dislikes = (content.dislikes || 0) + 1;
                    stats.totalDislikes++;
                    if (currentEpisode) {
                        saveEpisodes();
                    } else {
                        saveMovies();
                    }
                    saveStats();
                    updateNowPlayingInfo(content);
                    alert('نأسف لأن المحتوى لم يعجبك، سنحاول تحسينه!');
                };
            }
            
            function playContent(url, content) {
                // Prepare video URL with start time if available
                let videoUrl = url;
                const startTime = watchProgress[content.id] ? Math.floor(watchProgress[content.id].time) : 0;
                
                if (videoUrl.includes('youtube.com') || videoUrl.includes('youtu.be')) {
                    const videoId = extractYouTubeId(videoUrl);
                    if (videoId) {
                        videoUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&start=${startTime}`;
                    }
                } else if (videoUrl.includes('vimeo.com')) {
                    const videoId = videoUrl.split('/').pop();
                    // Vimeo doesn't support start time in embed URL
                    videoUrl = `https://player.vimeo.com/video/${videoId}?autoplay=1`;
                } else {
                    // For direct video links, you would need a custom player to support resume
                    videoUrl = url;
                }
                
                videoPlayer.src = videoUrl;
                
                // Start tracking progress
                trackProgress(content);
                
                // Save last played content
                localStorage.setItem('lastPlayedContent', JSON.stringify({
                    type: content.number ? 'episode' : 'movie',
                    id: content.id
                }));
            }
            
            function showAd(adType, callback) {
                isShowingAd = true;
                adOverlay.style.display = 'flex';
                adSkip.style.display = 'flex';
                
                // Set duration based on ad type
                let duration;
                if (adType === 'pre-roll') {
                    duration = adSettings.preRollDuration || 5;
                } else if (adType === 'mid-roll') {
                    duration = adSettings.midRollDuration || 10;
                } else if (adType === 'post-roll') {
                    duration = adSettings.postRollDuration || 10;
                }
                
                // Update countdown text
                adCountdown.textContent = `الإعلان ينتهي بعد ${duration} ثواني`;
                
                // Start countdown
                let seconds = duration;
                adTimer = setInterval(() => {
                    seconds--;
                    adCountdown.textContent = `الإعلان ينتهي بعد ${seconds} ثواني`;
                    
                    if (seconds <= 0) {
                        clearInterval(adTimer);
                        hideAd();
                        if (callback) callback();
                    }
                }, 1000);
                
                // Load ad content (using Adsterra)
                loadAdsterraAd();
                
                // Skip ad button
                adSkip.onclick = function() {
                    clearInterval(adTimer);
                    hideAd();
                    if (callback) callback();
                };
                
                // Track ad view
                if (adType === 'pre-roll') {
                    stats.adStats.preRollCount++;
                } else if (adType === 'mid-roll') {
                    stats.adStats.midRollCount++;
                } else if (adType === 'post-roll') {
                    stats.adStats.postRollCount++;
                }
                
                // Add revenue (0.001 per ad view)
                stats.adStats.totalRevenue += 0.001;
                
                saveStats();
                updateStats();
            }
            
            function hideAd() {
                isShowingAd = false;
                adOverlay.style.display = 'none';
                clearInterval(adTimer);
            }
            
            function loadAdsterraAd() {
                // In a real implementation, you would load the Adsterra ad here
                // For demo purposes, we'll just show a placeholder
                adContent.innerHTML = `
                    <div style="color:white; font-size:1.5rem; text-align:center; width:100%; height:100%; display:flex; justify-content:center; align-items:center;">
                        <div>
                            <div style="margin-bottom:20px;">إعلان تجاري</div>
                            <div style="font-size:0.8rem; color:#aaa;">هذا مكان إعلان Adsterra</div>
                        </div>
                    </div>
                `;
                console.log('Loading Adsterra ad...');
            }
            
            function loadBannerAd() {
                // In a real implementation, you would load the banner ad here
                // For demo purposes, we'll just show a placeholder
                bannerAd.innerHTML = `
                    <div style="color:white; font-size:1.2rem; padding:20px; text-align:center; width:100%;">
                        إعلان شريطي - Adsterra Network
                    </div>
                `;
                
                // Track banner ad view
                stats.adStats.bannerAdCount++;
                saveStats();
                updateStats();
            }
            
            function trackProgress(content) {
                // Clear any existing interval
                if (progressInterval) clearInterval(progressInterval);
                
                // Start tracking progress
                progressInterval = setInterval(() => {
                    // In a real implementation, you would get the current time from the video player
                    // For demo purposes, we'll simulate progress
                    const duration = content.duration ? content.duration * 60 : 600; // default to 10 minutes
                    const progress = Math.min((watchProgress[content.id]?.progress || 0) + 0.5, 100);
                    const currentTime = (progress / 100) * duration;
                    
                    watchProgress[content.id] = {
                        progress: progress,
                        time: currentTime,
                        timestamp: new Date().getTime()
                    };
                    
                    localStorage.setItem('watchProgress', JSON.stringify(watchProgress));
                    
                    // Update progress bar on card
                    const selector = content.number ? 
                        `.episode-card[data-episode-id="${content.id}"] .progress-bar` :
                        `.episode-card[data-movie-id="${content.id}"] .progress-bar`;
                    
                    const progressBar = document.querySelector(selector);
                    if (progressBar) {
                        progressBar.style.width = `${progress}%`;
                    }
                    
                    // Show mid-roll ad if enabled and at 50% progress
                    if (adSettings.midRollEnabled && progress >= 50 && progress < 55 && !content.midRollShown) {
                        if (!isShowingAd) {
                            content.midRollShown = true;
                            showAd('mid-roll', () => {
                                // Continue playing after ad
                            });
                        }
                    }
                    
                    // Show post-roll ad if enabled and near end
                    if (adSettings.postRollEnabled && progress >= 95 && !content.postRollShown) {
                        if (!isShowingAd) {
                            content.postRollShown = true;
                            showAd('post-roll', () => {
                                // Video has ended
                            });
                        }
                    }
                }, 3000); // Update every 3 seconds
            }
            
            function checkLastPlayed() {
                const lastPlayed = JSON.parse(localStorage.getItem('lastPlayedContent'));
                if (lastPlayed) {
                    if (lastPlayed.type === 'episode') {
                        const episode = episodes.find(e => e.id === lastPlayed.id);
                        if (episode) {
                            updateNowPlayingInfo(episode);
                        }
                    } else {
                        const movie = movies.find(m => m.id === lastPlayed.id);
                        if (movie) {
                            updateNowPlayingInfo(movie);
                        }
                    }
                } else {
                    // Hide now playing info initially
                    nowPlayingInfo.style.display = 'none';
                }
            }
            
            function saveSeries() {
                localStorage.setItem('smurfsSeries', JSON.stringify(series));
            }
            
            function saveEpisodes() {
                localStorage.setItem('smurfsEpisodes', JSON.stringify(episodes));
            }
            
            function saveMovies() {
                localStorage.setItem('smurfsMovies', JSON.stringify(movies));
            }
            
            function saveStats() {
                localStorage.setItem('stats', JSON.stringify(stats));
                updateStats();
            }
            
            function updateStats() {
                // Update stats in admin panel
                document.getElementById('totalViews').textContent = stats.totalViews;
                document.getElementById('totalLikes').textContent = stats.totalLikes;
                document.getElementById('totalDislikes').textContent = stats.totalDislikes;
                document.getElementById('totalAdRevenue').textContent = stats.adStats.totalRevenue.toFixed(3);
                document.getElementById('preRollCount').textContent = stats.adStats.preRollCount;
                document.getElementById('midRollCount').textContent = stats.adStats.midRollCount;
                document.getElementById('postRollCount').textContent = stats.adStats.postRollCount;
                document.getElementById('bannerAdCount').textContent = stats.adStats.bannerAdCount;
                
                // Find top episode
                if (episodes.length > 0) {
                    const topEpisode = episodes.reduce((prev, current) => 
                        (prev.views > current.views) ? prev : current);
                    document.getElementById('topEpisode').textContent = 
                        `${topEpisode.title} (${topEpisode.views} مشاهدة)`;
                }
                
                // Find top movie
                if (movies.length > 0) {
                    const topMovie = movies.reduce((prev, current) => 
                        (prev.views > current.views) ? prev : current);
                    document.getElementById('topMovie').textContent = 
                        `${topMovie.title} (${topMovie.views} مشاهدة)`;
                }
                
                // Calculate average watch time
                const watchTimes = Object.values(watchProgress).map(p => p.time / 60);
                const avgWatchTime = watchTimes.length > 0 ? 
                    (watchTimes.reduce((a, b) => a + b, 0) / watchTimes.length).toFixed(1) : 0;
                document.getElementById('avgWatchTime').textContent = avgWatchTime;
                
                // Update visitor stats
                document.getElementById('totalVisitors').textContent = stats.visitors.total;
                document.getElementById('newVisitors').textContent = stats.visitors.new;
                document.getElementById('returningVisitors').textContent = stats.visitors.returning;
                
                // Update visitor sources
                document.getElementById('facebookVisitors').textContent = stats.visitors.sources.facebook;
                document.getElementById('googleVisitors').textContent = stats.visitors.sources.google;
                document.getElementById('youtubeVisitors').textContent = stats.visitors.sources.youtube;
                document.getElementById('tiktokVisitors').textContent = stats.visitors.sources.tiktok;
                document.getElementById('instagramVisitors').textContent = stats.visitors.sources.instagram;
                document.getElementById('otherVisitors').textContent = stats.visitors.sources.other;
                
                // Calculate percentages
                const totalVisitors = stats.visitors.total || 1;
                document.getElementById('facebookPercentage').textContent = 
                    `${((stats.visitors.sources.facebook / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('googlePercentage').textContent = 
                    `${((stats.visitors.sources.google / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('youtubePercentage').textContent = 
                    `${((stats.visitors.sources.youtube / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('tiktokPercentage').textContent = 
                    `${((stats.visitors.sources.tiktok / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('instagramPercentage').textContent = 
                    `${((stats.visitors.sources.instagram / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('otherPercentage').textContent = 
                    `${((stats.visitors.sources.other / totalVisitors) * 100).toFixed(1)}%`;
                
                // Update device stats
                document.getElementById('mobileVisitors').textContent = stats.visitors.devices.mobile;
                document.getElementById('desktopVisitors').textContent = stats.visitors.devices.desktop;
                document.getElementById('tabletVisitors').textContent = stats.visitors.devices.tablet;
                document.getElementById('tvVisitors').textContent = stats.visitors.devices.tv;
                
                document.getElementById('mobilePercentage').textContent = 
                    `${((stats.visitors.devices.mobile / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('desktopPercentage').textContent = 
                    `${((stats.visitors.devices.desktop / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('tabletPercentage').textContent = 
                    `${((stats.visitors.devices.tablet / totalVisitors) * 100).toFixed(1)}%`;
                document.getElementById('tvPercentage').textContent = 
                    `${((stats.visitors.devices.tv / totalVisitors) * 100).toFixed(1)}%`;
            }
            
            function extractYouTubeId(url) {
                const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
                const match = url.match(regExp);
                return (match && match[2].length === 11) ? match[2] : null;
            }
            
            function setupEventListeners() {
                // Admin toggle
                adminToggle.addEventListener('click', function() {
                    const password = prompt('أدخل كلمة المرور للإدارة:');
                    if (password === ADMIN_PASSWORD) {
                        adminPanel.style.display = 'block';
                        updateStats();
                    } else if (password !== null) {
                        alert('كلمة المرور غير صحيحة');
                    }
                });
                
                // Close admin panel
                closeAdmin.addEventListener('click', function() {
                    adminPanel.style.display = 'none';
                });
                
                // Admin tabs
                adminTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabId = this.dataset.tab;
                        
                        // Update active tab
                        adminTabs.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Show corresponding content
                        adminTabContents.forEach(content => {
                            content.classList.remove('active');
                            if (content.id === `${tabId}Tab`) {
                                content.classList.add('active');
                            }
                        });
                    });
                });
                
                // Content tabs
                seriesTab.addEventListener('click', function() {
                    seriesTab.classList.add('active');
                    moviesTab.classList.remove('active');
                    contentTypeTitle.textContent = 'قائمة المسلسلات';
                    seriesSection.style.display = 'block';
                    episodesSection.style.display = 'none';
                    seasonsSection.style.display = 'none';
                    recommendedSection.style.display = 'none';
                    playerSection.style.display = 'none';
                    heroSlider.style.display = 'block';
                });
                
                moviesTab.addEventListener('click', function() {
                    moviesTab.classList.add('active');
                    seriesTab.classList.remove('active');
                    contentTypeTitle.textContent = 'قائمة الأفلام';
                    seriesSection.style.display = 'none';
                    episodesSection.style.display = 'none';
                    seasonsSection.style.display = 'none';
                    recommendedSection.style.display = 'none';
                    playerSection.style.display = 'none';
                    heroSlider.style.display = 'block';
                });
                
                // Back to series button
                backToSeries.addEventListener('click', function() {
                    seriesSection.style.display = 'block';
                    episodesSection.style.display = 'none';
                    seasonsSection.style.display = 'none';
                    recommendedSection.style.display = 'none';
                    playerSection.style.display = 'none';
                    heroSlider.style.display = 'block';
                });
                
                // Search functionality
                searchBtn.addEventListener('click', searchContent);
                searchBox.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchContent();
                    }
                });
                
                // Add series button
                document.getElementById('addSeriesBtn').addEventListener('click', function() {
                    document.getElementById('seriesForm').style.display = 'block';
                });
                
                // Cancel series button
                document.getElementById('cancelSeries').addEventListener('click', function() {
                    document.getElementById('seriesForm').style.display = 'none';
                });
                
                // Save series
                document.getElementById('saveSeries').addEventListener('click', function() {
                    const title = document.getElementById('seriesTitle').value.trim();
                    const description = document.getElementById('seriesDescription').value.trim();
                    const thumb = document.getElementById('seriesThumb').value.trim();
                    const rating = parseFloat(document.getElementById('seriesRating').value);
                    const genre = document.getElementById('seriesGenre').value.trim();
                    const episodesCount = parseInt(document.getElementById('seriesEpisodes').value);
                    const language = document.getElementById('seriesLanguage').value.trim();
                    const country = document.getElementById('seriesCountry').value.trim();
                    const season = parseInt(document.getElementById('seriesSeason').value);
                    const status = document.getElementById('seriesStatus').value;
                    
                    if (!title) {
                        alert('الرجاء إدخال عنوان المسلسل');
                        return;
                    }
                    
                    const newSeries = {
                        id: `series_${Date.now()}`,
                        title: title,
                        description: description,
                        thumb: thumb || 'https://via.placeholder.com/300x450?text=' + encodeURIComponent(title),
                        rating: rating || 7.5,
                        genre: genre || 'مغامرات',
                        episodes: episodesCount || 1,
                        language: language || 'مدبلج',
                        country: country || 'بلجيكا',
                        season: season || 1,
                        status: status || 'regular',
                        views: 0,
                        likes: 0,
                        dislikes: 0,
                        createdAt: new Date().toISOString(),
                        isFeatured: false
                    };
                    
                    series.push(newSeries);
                    saveSeries();
                    renderSeries();
                    
                    // Reset form
                    document.getElementById('seriesTitle').value = '';
                    document.getElementById('seriesDescription').value = '';
                    document.getElementById('seriesThumb').value = '';
                    document.getElementById('seriesRating').value = '';
                    document.getElementById('seriesGenre').value = '';
                    document.getElementById('seriesEpisodes').value = '';
                    document.getElementById('seriesLanguage').value = '';
                    document.getElementById('seriesCountry').value = '';
                    document.getElementById('seriesSeason').value = '';
                    document.getElementById('seriesStatus').value = 'regular';
                    
                    document.getElementById('seriesForm').style.display = 'none';
                    
                    alert('تم إضافة المسلسل بنجاح');
                });
                
                // Save episode
                document.getElementById('saveEpisode').addEventListener('click', function() {
                    const seriesId = document.getElementById('episodeSeries').value;
                    const number = parseInt(episodeNumber.value);
                    const title = episodeTitle.value.trim();
                    const url = episodeUrl.value.trim();
                    const thumb = episodeThumb.value.trim();
                    const duration = parseInt(episodeDuration.value);
                    const imdb = parseFloat(episodeImdb.value);
                    
                    if (!seriesId) {
                        alert('الرجاء اختيار مسلسل');
                        return;
                    }
                    
                    if (!number || number < 1) {
                        alert('الرجاء إدخال رقم حلقة صحيح');
                        return;
                    }
                    
                    if (!url) {
                        alert('الرجاء إدخال رابط الحلقة');
                        return;
                    }
                    
                    const newEpisode = {
                        id: `episode_${seriesId}_${number}`,
                        seriesId: seriesId,
                        number: number,
                        title: title || `الحلقة ${number}`,
                        url: url,
                        thumb: thumb || 'https://via.placeholder.com/300x170?text=صورة+الحلقة+' + number,
                        duration: duration || 24,
                        imdb: imdb || 7.5,
                        views: 0,
                        likes: 0,
                        dislikes: 0,
                        createdAt: new Date().toISOString()
                    };
                    
                    // Check if episode number already exists for this series
                    const existingIndex = episodes.findIndex(e => e.seriesId === seriesId && e.number === number);
                    if (existingIndex >= 0) {
                        if (!confirm(`الحلقة رقم ${number} موجودة بالفعل لهذا المسلسل. هل تريد استبدالها؟`)) {
                            return;
                        }
                        episodes[existingIndex] = newEpisode;
                    } else {
                        episodes.push(newEpisode);
                    }
                    
                    // Save to localStorage
                    saveEpisodes();
                    
                    // Re-render episodes if we're viewing this series
                    if (currentSeries && currentSeries.id === seriesId) {
                        renderEpisodes(seriesId);
                    }
                    
                    // Reset form
                    episodeNumber.value = '';
                    episodeTitle.value = '';
                    episodeUrl.value = '';
                    episodeThumb.value = '';
                    episodeDuration.value = '';
                    episodeImdb.value = '';
                    
                    alert(`تم ${existingIndex >= 0 ? 'تحديث' : 'إضافة'} الحلقة ${number} بنجاح`);
                });
                
                // Save movie
                document.getElementById('saveMovie').addEventListener('click', function() {
                    const title = movieTitle.value.trim();
                    const url = movieUrl.value.trim();
                    const thumb = movieThumb.value.trim();
                    const duration = parseInt(movieDuration.value);
                    const imdb = parseFloat(movieImdb.value);
                    
                    if (!title) {
                        alert('الرجاء إدخال عنوان الفيلم');
                        return;
                    }
                    
                    if (!url) {
                        alert('الرجاء إدخال رابط الفيلم');
                        return;
                    }
                    
                    const newMovie = {
                        id: `movie_${Date.now()}`,
                        title: title,
                        url: url,
                        thumb: thumb || 'https://via.placeholder.com/300x170?text=' + encodeURIComponent(title),
                        duration: duration || 90,
                        imdb: imdb || 7.0,
                        views: 0,
                        likes: 0,
                        dislikes: 0,
                        createdAt: new Date().toISOString(),
                        isFeatured: false
                    };
                    
                    movies.push(newMovie);
                    
                    // Save to localStorage
                    saveMovies();
                    
                    // Reset form
                    movieTitle.value = '';
                    movieUrl.value = '';
                    movieThumb.value = '';
                    movieDuration.value = '';
                    movieImdb.value = '';
                    
                    alert('تم إضافة الفيلم بنجاح');
                });
                
                // Save ad settings
                document.getElementById('saveAdsSettings').addEventListener('click', saveAdSettings);
                
                // Save settings
                document.getElementById('saveSettings').addEventListener('click', function() {
                    const siteTitle = document.getElementById('siteTitle').value;
                    const siteLogo = document.getElementById('siteLogo').value;
                    const channelLogo = document.getElementById('channelLogo').value;
                    const primaryColor = document.getElementById('primaryColor').value;
                    const siteMode = document.getElementById('siteMode').value;
                    const adminPassword = document.getElementById('adminPassword').value;
                    
                    // Update header
                    document.querySelector('.header h1').textContent = siteTitle;
                    document.querySelector('.logo-img').src = siteLogo;
                    document.querySelector('.channel-logo').src = channelLogo;
                    
                    // Update admin password
                    if (adminPassword) {
                        ADMIN_PASSWORD = adminPassword;
                    }
                    
                    // Update primary color
                    document.documentElement.style.setProperty('--primary-color', primaryColor);
                    
                    alert('تم حفظ الإعدادات بنجاح');
                });
                
                // Time range selector for visitors
                document.getElementById('visitorsTimeRange').addEventListener('change', function() {
                    // In a real app, this would filter the visitor data
                    updateStats();
                });
            }
            
            function searchContent() {
                const query = searchBox.value.trim().toLowerCase();
                if (!query) return;
                
                // Search in series
                const matchedSeries = series.filter(s => 
                    s.title.toLowerCase().includes(query) || 
                    (s.description && s.description.toLowerCase().includes(query)));
                
                // Search in movies
                const matchedMovies = movies.filter(m => 
                    m.title.toLowerCase().includes(query));
                
                if (matchedSeries.length > 0 || matchedMovies.length > 0) {
                    // Show series section with results
                    seriesSection.style.display = 'block';
                    episodesSection.style.display = 'none';
                    seasonsSection.style.display = 'none';
                    recommendedSection.style.display = 'none';
                    playerSection.style.display = 'none';
                    heroSlider.style.display = 'none';
                    
                    // Clear current grid
                    seriesGrid.innerHTML = '';
                    
                    // Add matched series
                    matchedSeries.forEach(ser => {
                        const seriesCard = document.createElement('div');
                        seriesCard.className = 'series-card';
                        seriesCard.dataset.seriesId = ser.id;
                        
                        const seriesThumbnail = document.createElement('div');
                        seriesThumbnail.className = 'series-thumbnail';
                        seriesThumbnail.style.backgroundImage = `url('${ser.thumb}')`;
                        
                        const seriesInfo = document.createElement('div');
                        seriesInfo.className = 'series-info';
                        
                        const seriesTitleEl = document.createElement('div');
                        seriesTitleEl.className = 'series-title';
                        seriesTitleEl.textContent = ser.title;
                        
                        const seriesMetaEl = document.createElement('div');
                        seriesMetaEl.className = 'series-meta';
                        seriesMetaEl.innerHTML = `
                            <span>${ser.rating} <i class="fas fa-star" style="color: #FFD700;"></i></span>
                            <span>•</span>
                            <span>${ser.season} موسم</span>
                        `;
                        
                        seriesInfo.appendChild(seriesTitleEl);
                        seriesInfo.appendChild(seriesMetaEl);
                        seriesCard.appendChild(seriesThumbnail);
                        seriesCard.appendChild(seriesInfo);
                        
                        seriesCard.addEventListener('click', function() {
                            showSeriesEpisodes(ser);
                        });
                        
                        seriesGrid.appendChild(seriesCard);
                    });
                    
                    // Add matched movies
                    matchedMovies.forEach(movie => {
                        const movieCard = document.createElement('div');
                        movieCard.className = 'series-card';
                        movieCard.dataset.movieId = movie.id;
                        
                        const movieThumbnail = document.createElement('div');
                        movieThumbnail.className = 'series-thumbnail';
                        movieThumbnail.style.backgroundImage = `url('${movie.thumb}')`;
                        
                        const movieInfo = document.createElement('div');
                        movieInfo.className = 'series-info';
                        
                        const movieTitleEl = document.createElement('div');
                        movieTitleEl.className = 'series-title';
                        movieTitleEl.textContent = movie.title;
                        
                        const movieMetaEl = document.createElement('div');
                        movieMetaEl.className = 'series-meta';
                        movieMetaEl.innerHTML = `
                            <span>${movie.imdb} <i class="fas fa-star" style="color: #FFD700;"></i></span>
                            <span>•</span>
                            <span>${movie.duration} دقيقة</span>
                        `;
                        
                        movieInfo.appendChild(movieTitleEl);
                        movieInfo.appendChild(movieMetaEl);
                        movieCard.appendChild(movieThumbnail);
                        movieCard.appendChild(movieInfo);
                        
                        movieCard.addEventListener('click', function() {
                            playMovie(movie);
                        });
                        
                        seriesGrid.appendChild(movieCard);
                    });
                    
                    // Update title
                    contentTypeTitle.textContent = `نتائج البحث عن: "${query}"`;
                } else {
                    alert('لا توجد نتائج مطابقة للبحث');
                }
            }
        });
    </script>
</body>
</html>